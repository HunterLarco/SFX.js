/* SFX.js 1.0.0
 * -----------------
 *
 * (c) 2013-2015 Hunter Larco <larcolabs.com>
 * SFX.js may be freely distributed under the MIT license.
 * For all details and documentation:
 * <https://github.com/HunterLarco/Color.js>
*/
var SFX=function(){var e=function(i,a){var a=a||new Function,i=i||0,o=t.createBufferSource(),s=t.createAnalyser();o.playbackRate.value=1,o.buffer=n,s.smoothingTimeConstant=.6,s.fftSize=1024,o.connect(s),s.connect(t.destination),o.gain.value=.6,o.noteGrainOn(0,i,n.duration-i),o.__defineGetter__("analyzer",function(){var e=new Uint8Array(this._analyzerDataNode.frequencyBinCount);return this._analyzerDataNode.getByteFrequencyData(e),e}.bind(o)),o._analyzerDataNode=s,o.duration=n.duration,o.__defineGetter__("currentTime",function(){if(0!=this.togglePlay.state)var e=this.togglePlay.state;else var e=((new Date).getTime()-this.togglePlay.last)/1e3+this.togglePlay.elapsed;return e>this.duration?this.duration:e}.bind(o)),o.__defineSetter__("currentTime",function(t){var i=this.environ.nodes[this.target];i.noteOff(0),i.paused?i.togglePlay.state=t:(this.environ.nodes.splice(this.target,1),n=i.buffer,e(t))}.bind({environ:this,target:this.nodes.length})),o.togglePlay=function(){var t=this.environ.nodes[this.target];t.togglePlay.state===!1?(t.togglePlay.state=t.currentTime,t.paused=!0,t.noteOff(0)):(this.environ.nodes.splice(this.target,1),n=t.buffer,e(t.togglePlay.state))}.bind({environ:this,target:this.nodes.length}),o.paused=!1,o.togglePlay.state=!1,o.togglePlay.last=(new Date).getTime(),o.togglePlay.elapsed=i,this.nodes.push(o);try{a()}catch(r){}}.bind(this),t=new(window.AudioContext||window.webkitAudioContext);this.__defineGetter__("context",function(){return t});var n=new ArrayBuffer;this.__defineGetter__("buffer",function(){return n}),this.nodes=new Array,this.togglePlay=function(e){var e=e||null;if(null===e)for(var t=0;t<this.nodes.length;t++)this.nodes[t].togglePlay();else this.nodes[e].togglePlay()}.bind(this),this.kill=function(e){var e=e||null;if(null===e){for(var t=0;t<this.nodes.length;t++)this.nodes[t].disconnect();this.nodes=[]}else this.nodes[e].disconnect(),this.nodes.splice(e,1)}.bind(this),this.open=function(i,a){var o=new XMLHttpRequest;o.open("GET",i,!0),o.responseType="arraybuffer",o.onload=function(o){n=o.target.response,t.decodeAudioData(n,function(t){n=t,e(null,a)}.bind(this),function(e){console.error("UNKNOWN ERROR: SFX cannot open "+i+";"+e.message)})}.bind(this),o.send()}.bind(this)};